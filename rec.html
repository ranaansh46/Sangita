<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Audio Recorder</title>
</head>

<body>
    <h1>System Audio Recorder</h1>
    <button id="recordButton">Record</button>
    <button id="stopButton" disabled>Stop</button>
    <br>
    <video id="videoPlayer" width="400" controls></video>
    <br>
    <audio id="audioPlayer" controls></audio>

    <script>
        let recordButton = document.getElementById('recordButton');
        let stopButton = document.getElementById('stopButton');
        let videoPlayer = document.getElementById('videoPlayer');
        let audioPlayer = document.getElementById('audioPlayer');
        let mediaRecorder;
        let recordedChunks = [];

        recordButton.addEventListener('click', startRecording);
        stopButton.addEventListener('click', stopRecording);

        function startRecording() {
            navigator.mediaDevices.getDisplayMedia({ audio: true, video: true })
                .then(function (stream) {
                    videoPlayer.srcObject = stream;
                     mediaRecorder = new MediaRecorder(stream);
                    mediaRecorder.addEventListener('dataavailable', function (event) {
                        recordedChunks.push(event.data);
                    });
                    mediaRecorder.start();
                    updateButtons(true);
                })
                .catch(function (error) {
                    console.error('Error accessing system audio:', error);
                });
        }

        function stopRecording() {
            mediaRecorder.stop();
            updateButtons(false);
            saveRecording();
        }

        function saveRecording() {
            let blob = new Blob(recordedChunks, { type: 'audio/webm' });
            recordedChunks = [];

            audioPlayer.src = URL.createObjectURL(blob);
            console.log(audioPlayer.src)
            audioPlayer.play();
        }

        function updateButtons(isRecording) {
            recordButton.disabled = isRecording;
            stopButton.disabled = !isRecording;
        }
    </script>
</body>

</html>

